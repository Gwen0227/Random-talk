---
import { cn } from '@/lib/utils'

interface Props {
  href: string
  external?: boolean
  class?: string
  underline?: boolean
  [key: string]: any
}

let { href, external, class: className, underline, ...rest } = Astro.props

// --- 路徑修復邏輯開始 ---
const base = import.meta.env.BASE_URL.replace(/\/$/, '') // 取得 /random-talk

// 如果是內部連結（以 / 開頭），且還沒加上 base，就自動補上
if (href.startsWith('/') && !href.startsWith(base) && !href.startsWith('http')) {
  href = `${base}${href}`.replace(/\/+/g, '/') // 確保不會出現雙斜線
}
// --- 路覽修復邏輯結束 ---
---

<a
  href={href}
  target={external ? '_blank' : '_self'}
  class={cn(
    'inline-block transition-colors duration-300 ease-in-out',
    underline &&
      'underline decoration-muted-foreground underline-offset-[3px] hover:decoration-foreground',
    className,
  )}
  {...rest}
>
  <slot />
</a>